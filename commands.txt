HF_DATASETS_CACHE=/data-3/priyam/tmp python perform_templating.py \
    --glob_path "/data-3/priyam/translation/data/wiki_en/wiki_en_data.parquet" \
    --cache_dir_for_original_data "/data-3/priyam/translation/data/wiki_en/cache" \
    --base_save_path "/data-3/priyam/translation/output/wiki_en/doc_csvs" \
    --save_path "/data-3/priyam/translation/output/wiki_en/template_wiki_en.csv" \
    --text_col body \
    --url_col url \
    --timestamp_col timestamp \
    --source_type wiki_en \
    --translation_type sentence \
    --use_cache \
    --write_to_mini_csvs \
    --write_style "doc" \
    --split "train[:5%]"

HF_DATASETS_CACHE=/data-3/priyam/tmp python perform_templating.py \
    --glob_path "/data-3/priyam/translation/data/wiki_en/wiki_en_data.parquet" \
    --cache_dir_for_original_data "/data-3/priyam/translation/data/wiki_en/cache" \
    --base_save_path "/data-3/priyam/translation/output/wiki_en/doc_csvs" \
    --save_path "/data-3/priyam/translation/output/wiki_en/templated" \
    --text_col body \
    --url_col url \
    --timestamp_col timestamp \
    --source_type wiki_en \
    --translation_type sentence \
    --use_cache \
    --split "train[:5%]"

#    --id_col ID_COL


        # data_files=glob.glob("/data-3/priyam/translation/refinedweb-mini/100_000.parquet"),
        # cache_dir="/data-3/priyam/translation/refinedweb-mini/cache",
        # rw_templated_filtered.to_csv(f"/data-3/priyam/translation/output/translation/template_{sample_size}.csv")

HF_DATASETS_CACHE=/home/llm/translate/tmp python translate_dummy.py \
    --data_glob_path "/home/llm/translate/output/wiki_en/doc_csvs/paths.csv" \
    --cache_dir "/home/llm/translate/data/wiki_en/cache" \
    --model_ckpt "ai4bharat/indictrans2-en-indic-dist-200M" \
    --src_lang "eng_Latn" \
    --dest_lang "hin_Deva" \
    --direction "en-indic" \
    --loader_workers 96 \
    --model_batch_size 1024 \
    --prefetch_factor 8 \
    --csv_batch_size 32 \
    --devices 0,1,2,3,4,5,6,7

HF_DATASETS_CACHE=/home/llm/translate/tmp python translate_dummy.py \
    --data_glob_path "/home/llm/translate/output/wiki_en/doc_csvs/paths.csv" \
    --cache_dir "/home/llm/translate/data/wiki_en/cache" \
    --model_ckpt "ai4bharat/indictrans2-en-indic-dist-200M" \
    --src_lang "eng_Latn" \
    --dest_lang "hin_Deva" \
    --direction "en-indic" \
    --loader_workers 96 \
    --model_batch_size 1024 \
    --prefetch_factor 8 \
    --csv_batch_size 32 \
    --devices 0

python create_global_ds.py \
    --paths_data "/home/llm/translate/output/wiki_en/doc_csvs/paths.csv" \
    --cache_dir "/home/llm/translate/data/wiki_en/cache" \
    --global_sent_ds_path "/home/llm/translate/output/wiki_en/global_sentences_wiki_en.csv"

python create_global_ds.py \
    --paths_data "/data-3/priyam/translation/output/wiki_en/templated/*.arrow" \
    --cache_dir "/data-3/priyam/translation/data/wiki_en/cache" \
    --global_sent_ds_path "/data-3/priyam/translation/output/wiki_en/sentences"

docker run --shm-size=2048m --gpus=\"device=0,1,2,3,4,5,6,7\" --rm -v ${PWD}/../checkpoints/:/models/checkpoints -p 8000:8000 -t indictrans2_triton



gcloud compute tpus tpu-vm create tpu-name \
    --zone=us-central2-b \
    --accelerator-type=v4-8 \
    --version=tpu-ubuntu2204-base

gcloud compute tpus tpu-vm create tlt-flax-build \
    --zone=europe-west4-a \
    --accelerator-type=v3-8 \
    --version=tpu-ubuntu2204-base \
    --preemptible


SETU_TRANSLATE_ROOT="/data/priyam/translation" bash /data/priyam/translation/setu-translate/scripts/run_binarize_and_translate.sh \
    --map_file "/data/priyam/translation/data/wiki-en/shards/mapping/device_map_0" \
    --data_cache_dir "/data/priyam/cache" \
    --joblib_temp_folder "/data/priyam/cache" \
    --src_lang "eng_Latn" \
    --tgt_lang "hin_Deva" \
    --num_procs_for_data_ops "64" \
    --batch_size "64" \
    --device "0" \
    --out_base_dir "/data/priyam/translation/outputs/wiki-en/shards_1627/out-longest" \
    --padding "longest"

SETU_TRANSLATE_ROOT="/data/priyam/translation" bash /data/priyam/translation/setu-translate/scripts/run_binarize_and_translate.sh \
    --map_file "/data/priyam/translation/data/wiki-en/shards/mapping/device_map_0" \
    --data_cache_dir "/data/priyam/cache" \
    --joblib_temp_folder "/data/priyam/cache" \
    --src_lang "eng_Latn" \
    --tgt_lang "hin_Deva" \
    --num_procs_for_data_ops "64" \
    --batch_size "64" \
    --device "0" \
    --out_base_dir "/data/priyam/translation/outputs/wiki-en/shards_1627/out" \
    --padding "max_length"

HF_DATASETS_CACHE=/data/priyam/tmp python /data/priyam/translation/setu-translate/stages/tpu/translate_tpu.py \
        --root_dir "$PWD" \
        --data_files "/data/priyam/translation/outputs/wiki-en/shards_1627/out/*/hin_Deva/binarized_sentences/*.arrow" \
        --cache_dir /data/priyam/tmp \
        --base_save_dir "/data/priyam/translation/outputs/wiki-en/shards_1627/tpu-out/full/hin_Deva/model_out" \
        --joblib_temp_folder /data/priyam/tmp \
        --batch_size 256 \
        --total_procs 64 \
        --devices 0,1


HF_DATASETS_CACHE=/data/priyam/tmp python /data/priyam/translation/setu-translate/stages/decode.py \
    --root_dir "$PWD" \
    --data_files "/data/priyam/translation/outputs/wiki-en/shards_1627/tpu-out/full/hin_Deva/model_out/devices_0_1_2_3_6_7/*.arrow" \
    --cache_dir /data/priyam/tmp \
    --decode_dir "/data/priyam/translation/outputs/wiki-en/shards_1627/tpu-out/full/hin_Deva/decoded" \
    --joblib_temp_folder /data/priyam/tmp \
    --batch_size 1024 \
    --total_procs 64 \
    --run_joblib False \
    --src_lang eng_Latn \
    --tgt_lang hin_Deva